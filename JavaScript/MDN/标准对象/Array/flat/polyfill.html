<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  
  <script>
    const arr = [1,2,[3,4]]
    const arr1 = [1,2,[3,4],[5,[6,7]]]

    console.log('flat', arr.flat())
    console.log('flat', arr1.flat(1))
    console.log('flat', arr1.flat(2))

    // 展开 一层
    const flat1 = (_arr) => _arr.reduce((pre, item) => pre.concat(item), [])
    console.log('flat1', flat1(arr))
    console.log('flat1', flat1(arr1))

    const flat2 = (_arr) => [].concat(..._arr)
    console.log('flat2', flat2(arr))
    console.log('flat2', flat2(arr1))

    // 展开多层
    const flatDeep = (_arr, deep = 1) =>
      deep > 0 
        ? _arr.reduce((pre, item) => pre.concat(Array.isArray(item)
          ? flatDeep(item, deep-1)
            : item), [])
              : _arr.slice()
    console.log('flatDeep', flatDeep(arr, 0))
    console.log('flatDeep', flatDeep(arr))
    console.log('flatDeep', flatDeep(arr1, 2))

    // 队列
    const flattenQueue = (_arr) => {
      const queue = [..._arr]
      const res = []
      while (queue.length) {
        const item = queue.shift()
        if (Array.isArray(item)) {
          queue.push(...item)
        } else {
          res.push(item)
        }
      }
      return res
    }
    console.log('flatten queue', flattenQueue(arr))
    console.log('flatten queue', flattenQueue(arr1))

    // 栈
    const flattenStack = (_arr) => {
      const stack = [..._arr]
      const res = []
      while (stack.length) {
        const item = stack.pop()
        if (Array.isArray(item)) {
          stack.push(...item)
        } else {
          res.push(item)
        }
      }
      return res.reverse()
    }
    console.log('flatten stack', flattenStack(arr))
    console.log('flatten stack', flattenStack(arr1))

    // 
    const forFlat = (_arr, _deep = 1) => {
      const flat = (__arr, __deep, res = []) => {
        for (const item of __arr) {
          if (Array.isArray(item) && __deep > 0) {
            flat(item, __deep - 1, res)
          } else {
            res.push(item)
          }
        }
        return res
      }
      return flat(_arr, _deep)
    }
    console.log('forFlat', forFlat(arr))
    console.log('forFlat', forFlat(arr1, 2))
  </script>
</body>
</html>